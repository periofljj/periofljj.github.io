<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>【译】JavaScript函数式编程的介绍 | Beauty of Dev.</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">【译】JavaScript函数式编程的介绍</h1><a id="logo" href="/.">Beauty of Dev.</a><p class="description">心有猛虎，细嗅蔷薇</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/timeline/"><i class="fa fa-book"> Timeline</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">【译】JavaScript函数式编程的介绍</h1><div class="post-meta">Jul 19, 2017<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2017/07/19/JavaScript函数式编程的介绍/" href="/2017/07/19/JavaScript函数式编程的介绍/#comments" class="ds-thread-count"></a><div class="post-content"><p><a href="https://opensource.com/article/17/6/functional-javascript" target="_blank" rel="external">原文链接</a></p>
<p>1995年，当Brendan Eich着手创建<code>JavaScript</code>时，他本打算实现一个浏览器中的<code>Scheme</code>。<code>Scheme</code>，作为<code>Lisp</code>的方言，是一种函数式编程语言。但当被告知新的语言应当是一种<code>Java</code>相关的脚本语言后，他改变主意确立了一种具有C语言风格语法(就像<code>Java</code>)的语言,还支持<code>first-class function</code>(即函数可以被当做参数传递给其他的函数，作为其他函数的返回值，也可以被赋给变量)。Java直到version 8,才从技术上支持<code>first-class function</code>，当然你可以使用匿名类(anonymous classes)来模拟<code>first-class functions</code>。这些<code>first-class functions</code>使得函数式编程在<code>JavaScript</code>中成为可能。</p>
<p><code>JavaScript</code>是一种多范式的语言，它允许你在编程中自由的混搭面向对象式，过程式和函数式的范式。最近，函数式编程的方式愈受青睐。在前端框架诸如<code>Angular</code>,<code>React</code>中，采用不变的数据结构能极大的提升性能。不变性是函数式编程的核心特性。它和纯函数使得你的代码更易于发现和调试错误。摒弃程序循环而采用函数能增加代码的可读性，并且让它看起来更加优雅。总的来说，函数式编程有很多的好处。</p>
<h3 id="什么不是函数式编程？"><a href="#什么不是函数式编程？" class="headerlink" title="什么不是函数式编程？"></a>什么不是函数式编程？</h3><p>在我们讨论函数式编程之前，应该先明确怎样不算是函数式编程。让我们谈谈在编写代码中你应该抛弃的语言结构:</p>
<ul>
<li><p><strong>Loops</strong></p>
<ul>
<li>while</li>
<li>do…while</li>
<li>for</li>
<li>for…of</li>
<li>for…in</li>
</ul>
</li>
<li><p><strong>使用var或者let进行变量声明</strong></p>
</li>
<li><p><strong>Void关键字声明的函数，即函数没有返回值</strong></p>
</li>
<li><p><strong>修改对象的值(e.g., o.x = 5;)</strong></p>
</li>
<li><p><strong>修改Array的方法</strong></p>
<ul>
<li>copyWithin</li>
<li>fill</li>
<li>pop</li>
<li>push</li>
<li>reverse</li>
<li>shift</li>
<li>sort</li>
<li>splice</li>
<li>unshift</li>
</ul>
</li>
<li><p><strong>修改Map的方法</strong></p>
<ul>
<li>clear</li>
<li>delete</li>
<li>set</li>
</ul>
</li>
<li><p><strong>修改Set的方法</strong></p>
<ul>
<li>add</li>
<li>clear</li>
<li>delete</li>
</ul>
</li>
</ul>
<p>但是你的代码中怎能没有这些特性呢？这是我们在接下来的几节中药讨论的。</p>
<h3 id="纯函数-Pure-functions"><a href="#纯函数-Pure-functions" class="headerlink" title="纯函数(Pure functions)"></a>纯函数(Pure functions)</h3><p>仅仅因为你的代码中包含函数并不代表你正在实践函数式编程。函数式编程通过编写的函数是纯函数还是非纯函数区分，它鼓励你编写纯函数。一个纯函数应该满足以下所有特性。</p>
<ul>
<li><strong>引用透明性</strong>：调用此函数，相同的参数对应相同的返回值。这意味着这个函数不应该依赖于任何可变状态。</li>
<li><strong>零副作用</strong>：这个函数不应该引发任何的副作用，此处的副作用包括但不限于：；I/O（e.g.,写入控制台或者日志文件），试图修改一个可变对象，重新赋值一个变量。</li>
</ul>
<p>让我们举几个例子阐明这个概念。首先，乘法函数就是一个纯函数的例子，相同的参数值总是对应同样的输出值，并且不会引起任何的副作用。如果乘法函数会将日志记录到控制台，就会成为一个非纯函数因为它引发了一个I/O副作用。</p>
<p>接下来是非纯函数的例子。<strong>canRide()</strong> 这个函数依赖于捕获 <strong>heightRequirement</strong> 变量(ps:闭包引用外部变量称为变量捕获，captured variable)。仅是捕获变量不一定会使函数不纯，但是捕获可变(或者说可被重新赋值)的变量会。在此种情况下，变量通过let关键字声明，这意味着此变量可被重新赋值。</p>
<p>以下的列表包含几个JavaScript的内部功能，它们是非纯函数。你可以说出它们不满足被称为纯函数必要的哪个条件吗？</p>
<ul>
<li><strong>console.log</strong></li>
<li><strong>element.addEventListener</strong></li>
<li><strong>Math.random</strong></li>
<li><strong>Date.now</strong></li>
<li><strong>$.ajax($代表你选择的Ajax库)</strong></li>
</ul>
<p>所有函数都是纯函数的情景虽然很完美，但是你可以从上面的列表看出，任何有意义的代码都会包含非纯函数。大多数时候我们都需要调用Ajax call，查看当前日期或者获得一个随机数。一个好的标准是遵循80/20原则：80%的函数应当是纯函数；剩下的20%，如果均为必要，可以是非纯函数。</p>
<p>以下是纯函数的一些好处：</p>
<ul>
<li>代码会易于发现和调试错误,因其不依赖于任何可变状态。</li>
<li>返回值可以被缓存以避免在将来重新计算它。</li>
<li>易于测试,因其没有任何的依赖项(例如日志记录、Ajax、数据库等).</li>
</ul>
<p>如果你一个你正在编写或者使用的函数是用Void关键字声明的，这个特征代表它是一个非纯函数。如果一个函数没有返回值，那么要么它是一个空操作，要么它会带来一些副作用。同理可得，如果你调用了一个函数但不使用它的返回值，你很可能使用它去产生一些副作用，并且它是一个非纯函数。</p>
<h3 id="不可变性-Immutability"><a href="#不可变性-Immutability" class="headerlink" title="不可变性(Immutability)"></a>不可变性(Immutability)</h3><p>让我们回到捕获变量的概念上。上文中我们简单的讨论了 <strong>canRide()</strong> 函数。我们说它是一个非纯函数，因为变量 <strong>heightRequirement</strong> 允许被重新赋值。这里有个人为的例子来说明它是怎样由于被重新赋值而引起不可预测的后果的：</p>
<p>重新强调一下捕获变量不一定会使一个函数不纯。我们可以重写 <strong>canRide()</strong> 函数，仅仅改变声明 <strong>heightRequirement</strong> 这个变量的方式，就能使其成为纯函数。</p>
<p>用关键字 <strong>const</strong> 来声明变量意味着这是一个常量。如果尝试对它重新赋值，服务器会报错。所以可以使用 <strong>const</strong> 关键字来声明变量避免值被修改，但是这里仍然有个问题，对象可以被修改。为了实现真正的不可变性，不仅要避免变量被重新赋值，并且数据结构也要不可变。JavaScript提供给我们一个方法—— <strong>Object.freeze</strong> 来防止对象被改变。</p>
<p>不可变性适用于所有的数据结构，包括arrays, maps, sets。这意味着我们不应当去调用修改它们的方法，就像 <strong>array.protptype.push</strong> 。因为它能修改已经存在的数组。我们可以创建一个和原先数组完全一样的新数组用于添加新的元素。事实上，每个类似的修改对象元素的方法都可以被替换为一个函数，它返回一个已按需修改的全新数组。当我们在使用Map 或者Set的时候也是如此。</p>
<p>如果你正在使用TypeScript编程，你可以使用 <strong>Readonly<t></t></strong>，<strong>ReadonlyArray<t></t></strong>，<strong>ReadonlyMap<k, v=""></k,></strong>，和 <strong>ReadonlySet<t></t></strong>。这样如果你试图修改任何的对象，都会编译报错。如果你对一个对象字面量或者数组调用 <strong>Object.freeze</strong> ,那么编译器会自动的指出它们是read-only的。由于Maps和Sets在内部表达的方式,对于这些数据结构调用 <strong>Object.freeze</strong> 的工作原理并不相同。但是能够轻易的告诉编译器你希望他们的是read-only的。</p>
<p><img src="/2017/07/19/JavaScript函数式编程的介绍/typescript-readonly.png" alt="TypeScript read-only interfaces"></p>
<p>所以我们了解到选择创建一个新的对象而不是修改原对象，能够避免为性能带来负面影响。记得要在自己开发的app中做性能测试。如果你需要提升性能，可以考虑使用 <strong>Immutable.js</strong> 。这个库使用稳定的数据结构实现了Lists, Stacks, Maps, Sets和其他的数据结构。这和诸如Clojure, Scala这类函数式编程语言使用了相同的内部技术。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://periofljj.github.io/2017/07/19/JavaScript函数式编程的介绍/" data-id="cj6yg0omd00011vrbs2kd8vgt" class="article-share-link">Share</a><div class="tags"><a href="/tags/JavaScript/">JavaScript</a><a href="/tags/英文翻译/">英文翻译</a></div><div class="post-nav"><a href="/2017/03/20/algorithm1/" class="next">程序媛数据结构与算法进阶（一）</a></div><div data-thread-key="2017/07/19/JavaScript函数式编程的介绍/" data-title="【译】JavaScript函数式编程的介绍" data-url="http://periofljj.github.io/2017/07/19/JavaScript函数式编程的介绍/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2017/07/19/JavaScript函数式编程的介绍/" data-title="【译】JavaScript函数式编程的介绍" data-url="http://periofljj.github.io/2017/07/19/JavaScript函数式编程的介绍/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://periofljj.github.io"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Technology/">Technology</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/英文翻译/" style="font-size: 15px;">英文翻译</a> <a href="/tags/H5/" style="font-size: 15px;">H5</a> <a href="/tags/组件开发/" style="font-size: 15px;">组件开发</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/07/19/JavaScript函数式编程的介绍/">【译】JavaScript函数式编程的介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/20/algorithm1/">程序媛数据结构与算法进阶（一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/16/web-storage/">客户端存储小结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/05/hello-world/">H5实现移动端可视化数据报告开发笔记</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> Recent Comments</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="http://www.linkedin.com/in/jingjing-liang-9252b7115" title="My Linkedin Page" target="_blank">My Linkedin Page</a><ul></ul><a href="http://1199game.com/" title="Jiang's blog" target="_blank">Jiang's blog</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Beauty of Dev..</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'periofljj'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>